#!/bin/bash
# Task 5 - Parallel fetching of PokÃ©mon data

pokemons=("bulbasaur" "ivysaur" "venusaur" "charmander" "charmeleon")
api_base="https://pokeapi.co/api/v2/pokemon"
error_file="errors.txt"

mkdir -p parallel_data
> "$error_file"  # Clear previous errors

fetch_pokemon() {
    local pokemon="$1"
    local file="parallel_data/${pokemon}.json"

    echo "Fetching $pokemon..."
    curl -s "$api_base/$pokemon" -o "$file"

    if [ $? -eq 0 ] && [ -s "$file" ]; then
        echo "Data for $pokemon saved."
    else
        echo "$pokemon" >> "$error_file"
    fi
}

# Fetch all in parallel
for p in "${pokemons[@]}"; do
    fetch_pokemon "$p" &
done

# Wait for all background jobs to finish
wait

echo "Parallel fetching complete."
